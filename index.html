<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¸æŒ™ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ - 1ç¥¨ã®å¤§åˆ‡ã•ã‚’å­¦ã¼ã†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .info-box {
            background: #f0f4ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-bottom: 30px;
            border-radius: 5px;
        }

        .info-box p {
            line-height: 1.6;
            color: #555;
        }

        .controls {
            margin-bottom: 30px;
        }

        .controls {
            margin-bottom: 30px;
        }

        .parties-row {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .control-group {
            margin-bottom: 15px;
            background: #f0f4ff;
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid #e8e8e8;
        }

        .parties-row .control-group {
            flex: 1;
            margin-bottom: 0;
        }

        .control-group.turnout-group {
            background: #f0f4ff;
            padding: 15px;
            margin-bottom: 20px;
            border: none;
        }

        .control-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
            font-size: 16px;
        }

        .control-group.turnout-group label {
            font-size: 16px;
            color: #667eea;
        }

        .input-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .arrow-btn {
            width: 28px;
            height: 28px;
            border: none;
            background: #e8ecff;
            color: #999;
            font-size: 14px;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .arrow-btn:hover {
            background: #d9dfff;
        }

        .arrow-btn:active {
            transform: scale(0.95);
        }

        .number-input {
            width: 90px;
            height: 40px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            border: none;              /* â† é’ã„æ ã‚’æ¶ˆã™ */
            border-radius: 5px;
            color: #667eea;
            background: white;
        }

        .number-input:focus {
            outline: none;             /* â† ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã®æ ã‚‚æ¶ˆã™ */
            border-color: transparent; /* â† å¿µã®ãŸã‚ */
        }

        .unit {
            font-size: 20px;
            font-weight: bold;
            color: #667eea;
        }

        .chart-container {
            margin: 50px 0;
            padding: 30px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.2);
        }

        .chart-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 25px;
            text-align: center;
            color: #333;
        }

        .bar-chart {
            width: 100%;
            height: 120px;
            display: flex;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
            border: none; /* â† ã‚°ãƒ©ãƒ•å‘¨ã‚Šã®é’ã„æ ã‚’æ¶ˆã™ */
        }

        .bar-segment {
            height: 100%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 22px;
        }

        .no-vote {
            background: #bbb;
        }

        .party-a {
            background: #ff6b6b;
        }

        .party-b {
            background: #4ecdc4;
        }

        .party-c {
            background: #ffe66d;
            color: #333;
        }

        .message {
            margin-top: 25px;
            padding: 20px;
            background: #fff9e6;
            border-left: 4px solid #ffd700;
            border-radius: 5px;
            line-height: 1.8;
            color: #555;
        }

        .message strong {
            color: #667eea;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 24px;
            }

            .bar-segment {
                font-size: 16px;
            }

            .parties-row {
                flex-direction: column;
                gap: 10px;
            }

            .parties-row .control-group {
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—³ï¸ é¸æŒ™ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
        <p class="subtitle">1ç¥¨ã®å¤§åˆ‡ã•ã‚’å­¦ã¼ã†</p>

        <div class="info-box">
            <p>
                å…¨éƒ¨ã§<strong>1000äºº</strong>ã®æœ‰æ¨©è€…ãŒã„ã¾ã™ã€‚<br>
                æŠ•ç¥¨ç‡ã‚’å¤‰ãˆãŸã‚Šã€å„å…šã¸ã®æŠ•ç¥¨æ•°ã‚’å¤‰ãˆãŸã‚Šã—ã¦ã€é¸æŒ™çµæœãŒã©ã†å¤‰ã‚ã‚‹ã‹è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼
            </p>
        </div>

        <div class="controls">
            <div class="control-group turnout-group">
                <label>ğŸ“Š æŠ•ç¥¨ç‡</label>
                <div class="input-container">
                    <button class="arrow-btn" onclick="changeTurnout(-1)">â–½</button>
                    <input type="number" id="turnout-input" class="number-input" min="0" max="100" value="50">
                    <span class="unit">%</span>
                    <button class="arrow-btn" onclick="changeTurnout(1)">â–³</button>
                </div>
            </div>

            <div class="parties-row">
                <div class="control-group party-a">
                    <label>ğŸ”´ Aå…š</label>
                    <div class="input-container">
                        <button class="arrow-btn" onclick="changeParty('a', -1)">â–½</button>
                        <input type="number" id="party-a-input" class="number-input" min="0" max="1000" value="200">
                        <span class="unit">äºº</span>
                        <button class="arrow-btn" onclick="changeParty('a', 1)">â–³</button>
                    </div>
                </div>

                <div class="control-group party-b">
                    <label>ğŸ”µ Bå…š</label>
                    <div class="input-container">
                        <button class="arrow-btn" onclick="changeParty('b', -1)">â–½</button>
                        <input type="number" id="party-b-input" class="number-input" min="0" max="1000" value="175">
                        <span class="unit">äºº</span>
                        <button class="arrow-btn" onclick="changeParty('b', 1)">â–³</button>
                    </div>
                </div>

                <div class="control-group party-c">
                    <label>ğŸŸ¡ Cå…š</label>
                    <div class="input-container">
                        <button class="arrow-btn" onclick="changeParty('c', -1)">â–½</button>
                        <input type="number" id="party-c-input" class="number-input" min="0" max="1000" value="125">
                        <span class="unit">äºº</span>
                        <button class="arrow-btn" onclick="changeParty('c', 1)">â–³</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="chart-container">
            <div class="chart-title">é¸æŒ™çµæœï¼ˆå…¨1000äººä¸­ï¼‰</div>
            <div class="bar-chart" id="chart">
                <div class="bar-segment no-vote" id="no-vote-bar">500äºº</div>
                <div class="bar-segment party-a" id="party-a-bar">200äºº</div>
                <div class="bar-segment party-b" id="party-b-bar">175äºº</div>
                <div class="bar-segment party-c" id="party-c-bar">125äºº</div>
            </div>
        </div>

        <div class="message" id="message">
            æŠ•ç¥¨ç‡ãŒ<strong>50%</strong>ã ã¨ã€1000äººã®ã†ã¡500äººã—ã‹æŠ•ç¥¨ã—ã¦ã„ã¾ã›ã‚“ã€‚<br>
            ã¤ã¾ã‚Šã€<strong>åŠåˆ†ã®äººã®æ„è¦‹ã ã‘</strong>ã§æ”¿æ²»ãŒæ±ºã¾ã£ã¦ã—ã¾ã„ã¾ã™ã€‚<br>
            ã‚ãªãŸã®1ç¥¨ã§çµæœãŒå¤‰ã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼
        </div>
    </div>

    <script>
        const TOTAL_VOTERS = 1000;

        const turnoutInput = document.getElementById('turnout-input');
        const partyAInput = document.getElementById('party-a-input');
        const partyBInput = document.getElementById('party-b-input');
        const partyCInput = document.getElementById('party-c-input');

        const noVoteBar = document.getElementById('no-vote-bar');
        const partyABar = document.getElementById('party-a-bar');
        const partyBBar = document.getElementById('party-b-bar');
        const partyCBar = document.getElementById('party-c-bar');

        const message = document.getElementById('message');

        function changeTurnout(direction) {
            let currentValue = parseInt(turnoutInput.value) || 0;
            currentValue = Math.max(0, Math.min(100, currentValue + direction));
            turnoutInput.value = currentValue;
            updateFromTurnout();
        }

        function changeParty(party, direction) {
            let input;
            if (party === 'a') input = partyAInput;
            else if (party === 'b') input = partyBInput;
            else input = partyCInput;

            let currentValue = parseInt(input.value) || 0;
            currentValue = Math.max(0, Math.min(TOTAL_VOTERS, currentValue + direction));
            input.value = currentValue;
            updateFromParties();
        }

        function updateFromTurnout() {
            const turnoutPercent = parseInt(turnoutInput.value) || 0;
            const totalVotes = Math.round(TOTAL_VOTERS * turnoutPercent / 100);
            
            // ç¾åœ¨ã®æŠ•ç¥¨æ•°ã®æ¯”ç‡ã‚’ä¿ã£ãŸã¾ã¾èª¿æ•´
            const currentA = parseInt(partyAInput.value) || 0;
            const currentB = parseInt(partyBInput.value) || 0;
            const currentC = parseInt(partyCInput.value) || 0;
            const currentTotal = currentA + currentB + currentC;

            if (currentTotal > 0) {
                partyAInput.value = Math.round(totalVotes * currentA / currentTotal);
                partyBInput.value = Math.round(totalVotes * currentB / currentTotal);
                partyCInput.value = totalVotes - parseInt(partyAInput.value) - parseInt(partyBInput.value);
            } else {
                partyAInput.value = Math.round(totalVotes * 0.4);
                partyBInput.value = Math.round(totalVotes * 0.35);
                partyCInput.value = totalVotes - parseInt(partyAInput.value) - parseInt(partyBInput.value);
            }

            updateChart();
        }

        function updateFromParties() {
            const partyAVotes = parseInt(partyAInput.value) || 0;
            const partyBVotes = parseInt(partyBInput.value) || 0;
            const partyCVotes = parseInt(partyCInput.value) || 0;
            const totalVotes = partyAVotes + partyBVotes + partyCVotes;

            // æŠ•ç¥¨ç‡ã‚’æ›´æ–°
            const newTurnout = Math.min(100, Math.round((totalVotes / TOTAL_VOTERS) * 100));
            turnoutInput.value = newTurnout;

            updateChart();
        }

        function updateChart() {
            const partyAVotes = parseInt(partyAInput.value) || 0;
            const partyBVotes = parseInt(partyBInput.value) || 0;
            const partyCVotes = parseInt(partyCInput.value) || 0;
            const totalVotes = partyAVotes + partyBVotes + partyCVotes;
            const noVote = TOTAL_VOTERS - totalVotes;
            const turnoutPercent = parseInt(turnoutInput.value) || 0;

            // ã‚°ãƒ©ãƒ•ã‚’æ›´æ–°
            noVoteBar.style.width = `${(noVote / TOTAL_VOTERS) * 100}%`;
            partyABar.style.width = `${(partyAVotes / TOTAL_VOTERS) * 100}%`;
            partyBBar.style.width = `${(partyBVotes / TOTAL_VOTERS) * 100}%`;
            partyCBar.style.width = `${(partyCVotes / TOTAL_VOTERS) * 100}%`;

            // ã‚°ãƒ©ãƒ•å†…ã®ãƒ†ã‚­ã‚¹ãƒˆ
            noVoteBar.textContent = noVote > 50 ? `${noVote}äºº` : '';
            partyABar.textContent = partyAVotes > 50 ? `${partyAVotes}äºº` : '';
            partyBBar.textContent = partyBVotes > 50 ? `${partyBVotes}äºº` : '';
            partyCBar.textContent = partyCVotes > 50 ? `${partyCVotes}äºº` : '';

            // å½“é¸æ”¿å…šã‚’åˆ¤å®š
            const votes = [
                { party: 'Aå…š', votes: partyAVotes, color: 'ğŸ”´' },
                { party: 'Bå…š', votes: partyBVotes, color: 'ğŸ”µ' },
                { party: 'Cå…š', votes: partyCVotes, color: 'ğŸŸ¡' }
            ];
            votes.sort((a, b) => b.votes - a.votes);
            
            const winner = votes[0];
            const second = votes[1];
            const third = votes[2];

            // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›´æ–°
            let messageText = '';
            
            if (totalVotes === 0) {
                messageText = `æŠ•ç¥¨ã—ãŸäººãŒèª°ã‚‚ã„ã¾ã›ã‚“ï¼<br>
                    ã“ã‚Œã§ã¯é¸æŒ™ã«ãªã‚Šã¾ã›ã‚“ã€‚<strong>å¿…ãšæŠ•ç¥¨ã«è¡Œãã¾ã—ã‚‡ã†ï¼</strong>`;
            } else {
                // å½“é¸çµæœ
                messageText = `<strong style="font-size: 18px;">${winner.color} ${winner.party}ãŒå½“é¸ã—ã¾ã—ãŸï¼ï¼ˆ${winner.votes}ç¥¨ï¼‰</strong><br><br>`;
                
                // åŸºæœ¬ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
                if (turnoutPercent < 30) {
                    messageText += `æŠ•ç¥¨ç‡ãŒ<strong>${turnoutPercent}%</strong>ã—ã‹ã‚ã‚Šã¾ã›ã‚“ã€‚
                        1000äººã®ã†ã¡<strong>ãŸã£ãŸ${totalVotes}äºº</strong>ã®æ„è¦‹ã ã‘ã§æ”¿æ²»ãŒæ±ºã¾ã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚<br>`;
                } else if (turnoutPercent < 50) {
                    messageText += `æŠ•ç¥¨ç‡ãŒ<strong>${turnoutPercent}%</strong>ã§ã™ã€‚
                        1000äººã®ã†ã¡${totalVotes}äººã—ã‹æŠ•ç¥¨ã—ã¦ã„ã¾ã›ã‚“ã€‚
                        <strong>åŠåˆ†ä»¥ä¸‹ã®äººã®æ„è¦‹ã ã‘</strong>ã§æ±ºã¾ã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚<br>`;
                } else if (turnoutPercent < 70) {
                    messageText += `æŠ•ç¥¨ç‡ãŒ<strong>${turnoutPercent}%</strong>ã§ã™ã€‚
                        1000äººã®ã†ã¡${totalVotes}äººãŒæŠ•ç¥¨ã—ã¦ã„ã¾ã™ã€‚
                        ã¾ãšã¾ãšã§ã™ãŒã€${noVote}äººãŒæŠ•ç¥¨ã—ã¦ã„ã¾ã›ã‚“ã€‚<br>`;
                } else if (turnoutPercent < 90) {
                    messageText += `æŠ•ç¥¨ç‡ãŒ<strong>${turnoutPercent}%</strong>ã§ã™ã€‚ç´ æ™´ã‚‰ã—ã„ï¼
                        1000äººã®ã†ã¡${totalVotes}äººãŒæŠ•ç¥¨ã—ã¦ã„ã¾ã™ã€‚
                        å¤šãã®äººã®å£°ãŒåæ˜ ã•ã‚Œã‚‹ã€ã¨ã¦ã‚‚<strong>å¥å…¨ãªæ°‘ä¸»ä¸»ç¾©</strong>ã§ã™ã€‚<br>`;
                } else {
                    messageText += `æŠ•ç¥¨ç‡ãŒ<strong>${turnoutPercent}%</strong>ã§ã™ã€‚å®Œç’§ï¼
                        ã»ã¼å…¨å“¡ãŒæŠ•ç¥¨ã«å‚åŠ ã—ã¦ã„ã¾ã™ã€‚
                        ã“ã‚Œã“ããŒ<strong>ç†æƒ³çš„ãªæ°‘ä¸»ä¸»ç¾©</strong>ã®å§¿ã§ã™ã€‚<br>`;
                }

                // æŠ•ç¥¨ã—ãªã‹ã£ãŸäººã¸ã®åˆ†æ
                if (noVote > 0 && winner.votes > 0) {
                    const votesNeededForSecond = winner.votes - second.votes + 1;
                    const votesNeededForThird = winner.votes - third.votes + 1;
                    
                    messageText += `<br><strong>ğŸ“Œ é‡è¦ï¼</strong><br>`;
                    
                    if (votesNeededForSecond <= noVote) {
                        const percentage = Math.round((votesNeededForSecond / noVote) * 100);
                        messageText += `æŠ•ç¥¨ã—ãªã‹ã£ãŸ${noVote}äººã®ã†ã¡ã€<strong>ãŸã£ãŸ${votesNeededForSecond}äººï¼ˆ${percentage}%ï¼‰</strong>ãŒ${second.color} ${second.party}ã«æŠ•ç¥¨ã—ã¦ã„ã‚Œã°ã€${second.party}ãŒå½“é¸ã§ãã¾ã—ãŸï¼<br>`;
                    }
                    
                    if (votesNeededForThird <= noVote && votesNeededForThird !== votesNeededForSecond) {
                        const percentage = Math.round((votesNeededForThird / noVote) * 100);
                        messageText += `æŠ•ç¥¨ã—ãªã‹ã£ãŸ${noVote}äººã®ã†ã¡ã€<strong>${votesNeededForThird}äººï¼ˆ${percentage}%ï¼‰</strong>ãŒ${third.color} ${third.party}ã«æŠ•ç¥¨ã—ã¦ã„ã‚Œã°ã€${third.party}ãŒå½“é¸ã§ãã¾ã—ãŸï¼<br>`;
                    }
                    
                    if (votesNeededForSecond <= noVote || votesNeededForThird <= noVote) {
                        messageText += `<br><strong>ã‚ãªãŸã®1ç¥¨ãŒçµæœã‚’å¤‰ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼</strong>`;
                    }
                }
            }

            message.innerHTML = messageText;
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
        turnoutInput.addEventListener('input', updateFromTurnout);
        partyAInput.addEventListener('input', updateFromParties);
        partyBInput.addEventListener('input', updateFromParties);
        partyCInput.addEventListener('input', updateFromParties);

        // åˆæœŸè¡¨ç¤º
        updateChart();
    </script>
</body>
</html>
